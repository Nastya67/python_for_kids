{% load staticfiles %}
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Leve{{lvl}}</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{% static 'css/code_style.css' %} ">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet" media="all">
    
  
</head>

<body>
    

    <!-- WINNER PAGE -->
    <div id="winner_images" style="display:none">
     <div id="winner_1" style="display:none">
         <div id="bg_trans" ></div>
     </div>

        <div id="winner_4" style="display:none">
         <img src="{% static 'img/boy.gif' %}"/>
     </div>
        <div id="winner_5" style="display:none">
         <div id="bg_trans_2"  style= "border-left:5px dashed white;">
             <div class="wrapper_header_" >
                 <div></div>
                <game_text>
                    <br>
                    {{man.name}}
                    <br>
                        {{wb}}<img src="{% static 'img/coin.png'%}" alt="coin" style="width:20px;">
                </game_text>
                <div></div>
             </div>
             <div class="wrapper_result" style="height:20%" >
                 <div>
                 </div>
                 <div></div>
                 <div></div>
             </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 400%;">CONGRATULATIONS!
             </game_text></span>
            </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 300%;">
                 <br><br>
            <a href="{% url 'level' next_lvl%}" > > NEXT LEVEL</a><br>
               -----------<br>
            <a href= "{%url 'main'%}"> > MENU</a><br>
               -----------<br>

        </game_text></span>
            </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 400%;">
             </game_text></span>
            </div>
        </div>

     </div>
        <div id="winner_2" style="display:none">
     </div>
        <div id="winner_3" style="display:none">
     </div>


    </div>


    <!-- LOOSER PAGE -->
    <div id="looser_images" style="display:none">
     <div id="looser_1" style="display:none">
         <div id="bg_trans" ></div>
     </div>

        <div id="looser_4" style="display:none">
         <img src="{% static 'img/boy_sad.gif' %}"/>
     </div>
        <div id="looser_5" style="display:none">
         <div id="bg_trans_2"  style= "border-left:5px dashed white;">
             <div class="wrapper_header_" >
                 <div></div>
                <game_text>
                    <br>
                    {{man.name}}
                    <br>
                        {{man.coins}}<img src="{% static 'img/coin.png'%}" alt="coin" style="width:20px;">
                </game_text>
                <div></div>
             </div>
             <div class="wrapper_result" style="height:15%" >
                 <div>
                 </div>
                 <div></div>
                 <div></div>
             </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 300%;">OOOPS! TRY AGAIN
             </game_text></span>
            </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 300%;">
                 <br><br>
            <a href="{% url 'level' lvl%}" > > LEVEL AGAIN</a><br>
               -----------<br>
            <a href= "{%url 'main'%}"> > MENU</a><br>
               -----------<br>

        </game_text></span>
            </div>
             <div class="wrapper_result">
                 <div></div>
             <span><game_text style="font-size: 400%;">
             </game_text></span>
            </div>
        </div>

     </div>
        <div id="looser_2" style="display:none">
     </div>
        <div id="looser_3" style="display:none">
     </div>


    </div>












    <div class="wrapper_header" style= "border-bottom:5px dashed white;">
        <game_text><a href = "{%url 'main'%}">MENU</a></game_text>
        <game_text>LEVEL {{lvl}}
        </game_text>
        <div></div>
    </div>
    <div class="wrapper" style= "border-bottom:5px dashed white;">
        {%csrf_token%}
        <div></div>
        <div >
        <span >
            <game_text>
                <div class="scroll">
                    {% for t in txt%}
                        {{t}}<br>
                    {%endfor%}
                </div>
            </game_text>
        </span>
        </div>
        <div style= "border-right:5px dashed white;"></div>
        <div></div>
        <span>
            <div id="container" style="width:900px;height:500px;border:1px solid black"></div></span>
        <div></div>
        
    </div>
    <div class="wrapper2">
        <div></div>
        <span><img src="{%static 'img/run.png'%}" alt="run" style="width:30px;" onclick = "run()"></span>
        <div></div>
        <span><img src="{%static 'img/check.png'%}" alt="check" style="width:50px;" onclick = "check()"></span>
        <div></div>
        <span><img src="{%static 'img/delete.png'%}" alt="delete" style="width:50px;" onclick = "del()"></span>
        <div></div>
        <span><p id="console"></p></span>
    </div>
    
    
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{%static 'js/bootstrap.min.js'%}"></script>
    
    <!-- our custom js scripts -->
    <script  src="{%static 'js/main_js.js'%}"></script>

<script src="{%static 'node_modules/monaco-editor/min/vs/loader.js'%}"></script>
<script>
	require.config({ paths: { 'vs': '../static/node_modules/monaco-editor/min/vs' }});

	require.config({
		'vs/nls' : {
			availableLanguages: {
				'*': 'de'
			}
		}
	});
    

	require(['vs/editor/editor.main'], function() {
        
        monaco.editor.defineTheme('myCustomTheme', {
	base: 'vs-dark', // can also be vs-dark or hc-black
	inherit: true, // can also be false to completely replace the builtin rules
	rules: [
		{ token: 'comment', foreground: '9C9CA0', fontStyle: 'italic' },
		{ token: 'comment.js', foreground: '008800', fontStyle: 'bold' },
		{ token: 'comment.css', foreground: '0000ff' } // will inherit fontStyle from `comment` above
	]
});
    
		editor = monaco.editor.create(document.getElementById('container'), {
			value: [
				''
			].join('\n'),
			language: 'python',
            theme: "myCustomTheme"
		});
		editorInput = editor.getValue();
		function saveInput()
        {
            editorInput = editor.getValue();
            //alert(editorInput);
        }
        document.getElementById('container').onchange = saveInput;
	});
function del(){
    editor.setValue("")
}
function check(){
    var xhr = new XMLHttpRequest();
    var newURL = window.location.protocol;
    xhr.open('POST', 'http://127.0.0.1:8000/learn/submit{{lvl}}', true);
    let csrftoken = document.getElementsByName("csrfmiddlewaretoken")[0].value
    xhr.setRequestHeader("X-CSRFToken", csrftoken)
    xhr.send(JSON.stringify(editorInput));
    xhr.onreadystatechange = function() { // (3)
        if (xhr.readyState != 4) return;
        if (xhr.status == 200){
            cons = document.getElementById("console");
            cons.innerText = xhr.responseText;
            show_winner();
        }
        else if (xhr.status == 201){
            cons = document.getElementById("console");
            cons.innerText = xhr.responseText;
            show_looser();
        }
        else{
          alert(xhr.status + ': ' + xhr.statusText);
      }}
}
function run()
{
    var xhr = new XMLHttpRequest();
    var newURL = window.location.protocol;
    xhr.open('POST', 'http://127.0.0.1:8000/learn/run{{lvl}}', true);
    let csrftoken = document.getElementsByName("csrfmiddlewaretoken")[0].value
    xhr.setRequestHeader("X-CSRFToken", csrftoken)
    xhr.send(JSON.stringify(editorInput));   
    xhr.onreadystatechange = function() { // (3)
        if (xhr.readyState != 4) return;
        if (xhr.status == 200 || xhr.status == 201){
            cons = document.getElementById("console");
            cons.innerText = xhr.responseText;
        }
        else{
          alert(xhr.status + ': ' + xhr.statusText);
      }}
    //alert(editorInput);
}

    function show_winner(){
        document.getElementById("winner_images").style.display = "block";
        for (var i = 1; i < 6; i++) {
            text="showNow_win("+i+")"
           setTimeout(text, 500+50*i);
        }
       }
    function showNow_win(i) {
    text="winner_"+i;
    document.getElementById(text).style.display = "block";

     }
    function show_looser(){
        document.getElementById("looser_images").style.display = "block";
        for (var i = 1; i < 6; i++) {
            text="showNow_loos("+i+")"
           setTimeout(text, 500+50*i);
        }
       }
    function showNow_loos(i) {
    text="looser_"+i;
    document.getElementById(text).style.display = "block";

     }

</script>
    
    
    <script type="text/javascript">
 $(document).ready(function() {
 $("body").css("display", "none");
 $("body").fadeIn(800);
 });
</script>


</body>
</html>